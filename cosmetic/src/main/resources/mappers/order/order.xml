<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="order">

<!-- 데이터 입력시 새로 생성된 primary key 가져오기 -->
<select id="getId" resultType="int">
	select LAST_INSERT_ID()
</select>

<select id="memberInfo" resultType="java.util.Map">
	SELECT NAME, phone, zipcode, address1, address2 FROM member
	WHERE userid=#{userid};
</select>

<!-- 장바구니의 상품 > 주문 아이템 테이블에 저장 -->
<insert id="orderItemInsert">
	INSERT INTO orderitem(
	p_id, amount, orderstatus
	) VALUES (
		#{p_id}, #{amount}, #{orderstatus}
	)
</insert>

<!-- 주문한 상품 목록 확인 -->
<select id="orderList" resultType="java.util.Map">
	select * from orderitem
	where orderItemId = #{itemId}
</select>

<!-- 상품정보 가져오기 -->
<select id="orderedProducts" resultType="java.util.Map">
	select * from product
	where p_id = #{p_id}
</select>

<!-- 주문테이블 데이터 입력 -->
<insert id="orderInsert">
	INSERT INTO orderlist (
		userid, orderItemId,
        price, deliverCost, totalPrice,
        method,
        username, zipcode, address1, address2, tel,
        userPoint
	) VALUES (
		#{userid}, #{orderItemId},
	    #{price}, #{deliverCost}, #{totalPrice},
	    #{method},
	    #{username}, #{zipcode}, #{address1}, #{address2}, #{tel},
	    #{userPoint}
	)
</insert>

<!-- 주문결과 확인 -->
<select id="orderSelect" resultType="com.example.cosmetic.model.order.OrderDTO">
	select * from orderlist
	where orderId = #{orderid}
</select>


</mapper>